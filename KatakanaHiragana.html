<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kana Trainer</title>
  <style>
    body { font-family: sans-serif; background: #f8f9fa; text-align: center; padding: 20px; }
    h1 { margin-bottom: 10px; }
    #question { font-size: 72px; margin: 20px; }
    .options button {
      font-size: 24px;
      padding: 10px 20px;
      margin: 10px;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background-color: #dee2e6;
      transition: 0.3s;
    }
    .options button:hover { background-color: #ced4da; }
    #scoreboard { margin-top: 20px; }
    #pauseBtn, #resumeBtn { margin: 10px; padding: 10px 20px; font-size: 16px; }
    #resumeBtn { display: none; }
    select { font-size: 16px; margin: 10px; padding: 5px; }
    header {
      background-color: #2c3e50;
      color: white;
      padding: 1rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header h1 {
      margin: 0;
      font-size: 1.5rem;
    }
    nav a {
      color: white;
      text-decoration: none;
      margin-left: 1.2rem;
      font-weight: 600;
    }
    nav a:hover {
      text-decoration: underline;
    }
    @media (max-width: 600px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }
      nav {
        margin-top: 0.5rem;
      }
      nav a {
        margin-left: 0;
        margin-right: 1rem;
      }
    }
      .degen-effect {
        background-image: url('sword-bg.png');
        background-size: cover;
      }
  </style>
</head>
<body>
  <div id="navbar"></div>
<script>
  fetch("navbar.html")
    .then(res => res.text())
    .then(html => {
      document.getElementById("navbar").innerHTML = html;
    });
</script>
  <h1>Kana Trainer</h1>
  <div>
    <button id="loginBtn" onclick="login()">Sign in with Google</button>
    <button id="logoutBtn" onclick="logout()" style="display: none;">Sign out</button>
    <p id="user">Not signed in</p>
  </div>
  <div>
    <label for="script">Script:</label>
    <select id="script">
      <option value="hiragana">Hiragana</option>
      <option value="katakana">Katakana</option>
    </select>
    <label for="category">Category:</label>
    <select id="category">
      <option value="a">a</option>
      <option value="ka">ka</option>
    </select>
  </div>
  <div id="question">?</div>
  <div class="options" id="options"></div>
  <div id="scoreboard">
    <p id="timer">Time: 10</p>
    <p>Score: <span id="score">0</span> | Streak: <span id="streak">0</span></p>
    <button id="pauseBtn">Pause</button>
    <button id="resumeBtn">Resume</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

  <a href="shop.html" style="margin-right:20px; color:white;">üõçÔ∏è Shop</a>
</div>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDaAyuSvzzk80iH8ydOTWBRhjkpsIZpYRI",
      authDomain: "hiragana-trainer.firebaseapp.com",
      projectId: "hiragana-trainer",
      storageBucket: "hiragana-trainer.appspot.com",
      messagingSenderId: "1061396749731",
      appId: "1:1061396749731:web:e3e349d735b9401a4ece16",
      measurementId: "G-BQGGQDPP9T"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    function login() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider).catch(error => alert(error.message));
    }

        function logout() {
          auth.signOut();
        }

        auth.onAuthStateChanged(user => {
          document.getElementById("loginBtn").style.display = user ? "none" : "inline-block";
          document.getElementById("logoutBtn").style.display = user ? "inline-block" : "none";
          document.getElementById("user").textContent = user ? `Signed in as: ${user.displayName}` : "Not signed in";
        });

        // KANA DATA (trimmed for brevity ‚Äî keep as is in your full version)
    const kanaData = {
      hiragana: {
        a: [
          { question: "„ÅÇ", correct: "a", options: ["a", "i", "u"] },
          { question: "„ÅÑ", correct: "i", options: ["e", "i", "a"] },
          { question: "„ÅÜ", correct: "u", options: ["o", "u", "e"] },
          { question: "„Åà", correct: "e", options: ["i", "e", "a"] },
          { question: "„Åä", correct: "o", options: ["o", "u", "e"] }
        ],
        ka: [
          { question: "„Åã", correct: "ka", options: ["ka", "ga", "ha"] },
          { question: "„Åç", correct: "ki", options: ["ki", "gi", "ri"] },
          { question: "„Åè", correct: "ku", options: ["ku", "gu", "su"] },
          { question: "„Åë", correct: "ke", options: ["ke", "ge", "te"] },
          { question: "„Åì", correct: "ko", options: ["ho", "ko", "mo"] }
        ],
        sa: [
          { question: "„Åï", correct: "sa", options: ["sa", "za", "ta"] },
          { question: "„Åó", correct: "shi", options: ["shi", "ji", "chi"] },
          { question: "„Åô", correct: "su", options: ["su", "zu", "tsu"] },
          { question: "„Åõ", correct: "se", options: ["se", "ze", "te"] },
          { question: "„Åù", correct: "so", options: ["so", "zo", "to"] }
        ],
        ta: [
          { question: "„Åü", correct: "ta", options: ["ta", "da", "na"] },
          { question: "„Å°", correct: "chi", options: ["chi", "ji", "shi"] },
          { question: "„Å§", correct: "tsu", options: ["tsu", "zu", "su"] },
          { question: "„Å¶", correct: "te", options: ["te", "de", "ne"] },
          { question: "„Å®", correct: "to", options: ["to", "do", "no"] }
        ],
        na: [
          { question: "„Å™", correct: "na", options: ["na", "ta", "ma"] },
          { question: "„Å´", correct: "ni", options: ["ni", "mi", "ri"] },
          { question: "„Å¨", correct: "nu", options: ["nu", "mu", "ku"] },
          { question: "„Å≠", correct: "ne", options: ["ne", "re", "me"] },
          { question: "„ÅÆ", correct: "no", options: ["no", "to", "mo"] }
        ],
        ha: [
          { question: "„ÅØ", correct: "ha", options: ["ha", "ba", "pa"] },
          { question: "„Å≤", correct: "hi", options: ["hi", "bi", "pi"] },
          { question: "„Åµ", correct: "fu", options: ["fu", "bu", "pu"] },
          { question: "„Å∏", correct: "he", options: ["he", "be", "pe"] },
          { question: "„Åª", correct: "ho", options: ["ho", "bo", "po"] }
        ],
        ma: [
          { question: "„Åæ", correct: "ma", options: ["ma", "na", "ba"] },
          { question: "„Åø", correct: "mi", options: ["mi", "ni", "ri"] },
          { question: "„ÇÄ", correct: "mu", options: ["mu", "nu", "ku"] },
          { question: "„ÇÅ", correct: "me", options: ["me", "ne", "re"] },
          { question: "„ÇÇ", correct: "mo", options: ["mo", "no", "to"] }
        ],
        ya: [
          { question: "„ÇÑ", correct: "ya", options: ["ya", "wa", "ra"] },
          { question: "„ÇÜ", correct: "yu", options: ["yu", "yo", "yu"] },
          { question: "„Çà", correct: "yo", options: ["yo", "yu", "ya"] }
        ],
        ra: [
          { question: "„Çâ", correct: "ra", options: ["ra", "la", "na"] },
          { question: "„Çä", correct: "ri", options: ["ri", "li", "mi"] },
          { question: "„Çã", correct: "ru", options: ["ru", "lu", "ku"] },
          { question: "„Çå", correct: "re", options: ["re", "le", "ne"] },
          { question: "„Çç", correct: "ro", options: ["ro", "lo", "to"] }
        ],
        wa: [
          { question: "„Çè", correct: "wa", options: ["wa", "ra", "ma"] },
          { question: "„Çí", correct: "wo", options: ["wo", "o", "mo"] }
        ],
        n: [
          { question: "„Çì", correct: "n", options: ["n", "m", "nn"] }
        ]
      },
      katakana: {
        a: [
          { question: "„Ç¢", correct: "a", options: ["a", "i", "u"] },
          { question: "„Ç§", correct: "i", options: ["e", "i", "a"] },
          { question: "„Ç¶", correct: "u", options: ["o", "u", "e"] },
          { question: "„Ç®", correct: "e", options: ["i", "e", "a"] },
          { question: "„Ç™", correct: "o", options: ["o", "u", "e"] }
        ],
        ka: [
          { question: "„Ç´", correct: "ka", options: ["ka", "ga", "ha"] },
          { question: "„Ç≠", correct: "ki", options: ["ki", "gi", "ri"] },
          { question: "„ÇØ", correct: "ku", options: ["ku", "gu", "su"] },
          { question: "„Ç±", correct: "ke", options: ["ke", "ge", "te"] },
          { question: "„Ç≥", correct: "ko", options: ["ho", "ko", "mo"] }
        ],
        sa: [
          { question: "„Çµ", correct: "sa", options: ["sa", "za", "ta"] },
          { question: "„Ç∑", correct: "shi", options: ["shi", "ji", "chi"] },
          { question: "„Çπ", correct: "su", options: ["su", "zu", "tsu"] },
          { question: "„Çª", correct: "se", options: ["se", "ze", "te"] },
          { question: "„ÇΩ", correct: "so", options: ["so", "zo", "to"] }
        ],
        ta: [
          { question: "„Çø", correct: "ta", options: ["ta", "da", "na"] },
          { question: "„ÉÅ", correct: "chi", options: ["chi", "ji", "shi"] },
          { question: "„ÉÑ", correct: "tsu", options: ["tsu", "zu", "su"] },
          { question: "„ÉÜ", correct: "te", options: ["te", "de", "ne"] },
          { question: "„Éà", correct: "to", options: ["to", "do", "no"] }
        ],
        na: [
          { question: "„Éä", correct: "na", options: ["na", "ta", "ma"] },
          { question: "„Éã", correct: "ni", options: ["ni", "mi", "ri"] },
          { question: "„Éå", correct: "nu", options: ["nu", "mu", "ku"] },
          { question: "„Éç", correct: "ne", options: ["ne", "re", "me"] },
          { question: "„Éé", correct: "no", options: ["no", "to", "mo"] }
        ],
        ha: [
          { question: "„Éè", correct: "ha", options: ["ha", "ba", "pa"] },
          { question: "„Éí", correct: "hi", options: ["hi", "bi", "pi"] },
          { question: "„Éï", correct: "fu", options: ["fu", "bu", "pu"] },
          { question: "„Éò", correct: "he", options: ["he", "be", "pe"] },
          { question: "„Éõ", correct: "ho", options: ["ho", "bo", "po"] }
        ],
        ma: [
          { question: "„Éû", correct: "ma", options: ["ma", "na", "ba"] },
          { question: "„Éü", correct: "mi", options: ["mi", "ni", "ri"] },
          { question: "„É†", correct: "mu", options: ["mu", "nu", "ku"] },
          { question: "„É°", correct: "me", options: ["me", "ne", "re"] },
          { question: "„É¢", correct: "mo", options: ["mo", "no", "to"] }
        ],
        ya: [
          { question: "„É§", correct: "ya", options: ["ya", "wa", "ra"] },
          { question: "„É¶", correct: "yu", options: ["yu", "yo", "yu"] },
          { question: "„É®", correct: "yo", options: ["yo", "yu", "ya"] }
        ],
        ra: [
          { question: "„É©", correct: "ra", options: ["ra", "la", "na"] },
          { question: "„É™", correct: "ri", options: ["ri", "li", "mi"] },
          { question: "„É´", correct: "ru", options: ["ru", "lu", "ku"] },
          { question: "„É¨", correct: "re", options: ["re", "le", "ne"] },
          { question: "„É≠", correct: "ro", options: ["ro", "lo", "to"] }
        ],
        wa: [
          { question: "„ÉØ", correct: "wa", options: ["wa", "ra", "ma"] },
          { question: "„É≤", correct: "wo", options: ["wo", "o", "mo"] }
        ],
        n: [
          { question: "„É≥", correct: "n", options: ["n", "m", "nn"] }
        ]
      }
    };

    let currentScript = 'hiragana';
    let currentCategory = 'a';
    let currentQuestion;
    let timer = 10;
    let timerId;
    let score = 0;
    let streak = 0;
    let isPaused = false;
    let answerLock = false;

    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");
    const scoreEl = document.getElementById("score");
    const streakEl = document.getElementById("streak");
    const timerEl = document.getElementById("timer");
    const pauseBtn = document.getElementById("pauseBtn");
    const resumeBtn = document.getElementById("resumeBtn");

    function pickQuestion() {
      const questions = kanaData[currentScript][currentCategory];
      if (!questions) {
        questionEl.textContent = "No questions for this category.";
        optionsEl.innerHTML = "";
        return;
      }
      currentQuestion = questions[Math.floor(Math.random() * questions.length)];
    }

    function renderQuestion() {
      questionEl.textContent = currentQuestion.question;
      optionsEl.innerHTML = "";
      currentQuestion.options.forEach(option => {
        const btn = document.createElement("button");
        btn.textContent = option;
        btn.onclick = () => answer(option, btn);
        optionsEl.appendChild(btn);
      });
      answerLock = false;
    }

    function answer(selected, btn) {
      if (answerLock) return;
      answerLock = true;
      [...optionsEl.children].forEach(b => b.disabled = true);

      if (selected === currentQuestion.correct) {
        btn.style.backgroundColor = "#28a745";
        score++;
        streak++;
      } else {
        btn.style.backgroundColor = "#dc3545";
        streak = 0;
      }

      updateScore();
      setTimeout(() => nextQuestion(), 700);
    }

    function updateScore() {
      scoreEl.textContent = score;
      streakEl.textContent = streak;
    }

    function startTimer() {
      clearInterval(timerId);
      timer = 10;
      timerEl.textContent = `Time: ${timer}`;
      timerId = setInterval(() => {
        if (!isPaused) {
          timer--;
          timerEl.textContent = `Time: ${timer}`;
          if (timer <= 0) {
            clearInterval(timerId);
            streak = 0;
            updateScore();
            nextQuestion();
          }
        }
      }, 1000);
    }

    function nextQuestion() {
      pickQuestion();
      if (!currentQuestion) return;
      renderQuestion();
      startTimer();
    }

    pauseBtn.onclick = () => {
      isPaused = true;
      clearInterval(timerId);
      pauseBtn.style.display = "none";
      resumeBtn.style.display = "inline-block";
    };

    resumeBtn.onclick = () => {
      isPaused = false;
      pauseBtn.style.display = "inline-block";
      resumeBtn.style.display = "none";
      nextQuestion();
    };

    document.getElementById("script").onchange = e => {
      currentScript = e.target.value;
      score = 0;
      streak = 0;
      updateScore();
      nextQuestion();
    };

    document.getElementById("category").onchange = e => {
      currentCategory = e.target.value;
      score = 0;
      streak = 0;
      updateScore();
      nextQuestion();
    };

    window.onload = () => {
      nextQuestion();
    };
    let multiplier = 1;

function addPoints(points) {
  score += points * multiplier;
  updateScore();
}
let activeItems = [];

auth.onAuthStateChanged(async user => {
  if (user) {
    userId = user.uid;
    const doc = await db.collection("users").doc(userId).get();
    score = doc.data().score || 0;
    activeItems = doc.data().items || [];

    // Activate effects
    if (activeItems.includes("double_score")) {
      multiplier = 2;
    }
    if (activeItems.includes("extra_time")) {
      time += 3;
    }
    if (activeItems.includes("degen")) {
      document.body.classList.add("degen-effect"); // Add custom style or sound
    }

    updateScore();
  }
});

  </script>
</body>
</html>
