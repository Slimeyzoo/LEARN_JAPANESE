<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Kana Trainer</title>
  <style>
    body { font-family: sans-serif; background: #f8f9fa; text-align: center; padding: 20px; }
    h1 { margin-bottom: 10px; }
    #question { font-size: 72px; margin: 20px; }
    .options button {
      font-size: 24px;
      padding: 10px 20px;
      margin: 10px;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background-color: #dee2e6;
      transition: 0.3s;
    }
    .options button:hover { background-color: #ced4da; }
    #scoreboard { margin-top: 20px; }
    #pauseBtn, #resumeBtn { margin: 10px; padding: 10px 20px; font-size: 16px; }
    #resumeBtn { display: none; }
    select { font-size: 16px; margin: 10px; padding: 5px; }
  </style>
  <!-- Kompatible Firebase SDKs für klassische HTML-Seiten -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
</head>
<body>
  <h1>Kana Trainer</h1>
  <div>
    <button id="loginBtn" onclick="login()">Mit Google anmelden</button>
    <button id="logoutBtn" onclick="logout()" style="display: none;">Abmelden</button>
    <p id="user">Nicht angemeldet</p>
  </div>
  <div>
    <label for="script">Schriftsystem:</label>
    <select id="script">
      <option value="hiragana">Hiragana</option>
      <option value="katakana">Katakana</option>
    </select>
    <label for="category">Kategorie:</label>
    <select id="category">
      <option value="a">a</option>
      <option value="ka">ka</option>
    </select>
  </div>
  <div id="question">?</div>
  <div class="options" id="options"></div>
  <div id="scoreboard">
    <p id="timer">Zeit: 10</p>
    <p>Punkte: <span id="score">0</span> | Streak: <span id="streak">0</span></p>
    <button id="pauseBtn">Pause</button>
    <button id="resumeBtn">Weiter</button>
  </div>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDaAyuSvzzk80iH8ydOTWBRhjkpsIZpYRI",
      authDomain: "hiragana-trainer.firebaseapp.com",
      projectId: "hiragana-trainer",
      storageBucket: "hiragana-trainer.appspot.com",
      messagingSenderId: "1061396749731",
      appId: "1:1061396749731:web:e3e349d735b9401a4ece16",
      measurementId: "G-BQGGQDPP9T"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    function login() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider).catch(error => alert(error.message));
    }

    function logout() {
      auth.signOut();
    }

    auth.onAuthStateChanged(user => {
      const loginBtn = document.getElementById("loginBtn");
      const logoutBtn = document.getElementById("logoutBtn");
      const userDisplay = document.getElementById("user");

      if (user) {
        loginBtn.style.display = "none";
        logoutBtn.style.display = "inline-block";
        userDisplay.textContent = `Angemeldet als: ${user.displayName}`;
      } else {
        loginBtn.style.display = "inline-block";
        logoutBtn.style.display = "none";
        userDisplay.textContent = "Nicht angemeldet";
      }
    });

const kanaData = {
  hiragana: {
    a: [
      { question: "あ", correct: "a", options: ["a", "i", "u"] },
      { question: "い", correct: "i", options: ["e", "i", "a"] },
      { question: "う", correct: "u", options: ["o", "u", "e"] },
      { question: "え", correct: "e", options: ["i", "e", "a"] },
      { question: "お", correct: "o", options: ["o", "u", "e"] }
    ],
    ka: [
      { question: "か", correct: "ka", options: ["ka", "ga", "ha"] },
      { question: "き", correct: "ki", options: ["ki", "gi", "ri"] },
      { question: "く", correct: "ku", options: ["ku", "gu", "su"] },
      { question: "け", correct: "ke", options: ["ke", "ge", "te"] },
      { question: "こ", correct: "ko", options: ["ho", "ko", "mo"] }
    ],
    sa: [
      { question: "さ", correct: "sa", options: ["sa", "za", "ta"] },
      { question: "し", correct: "shi", options: ["shi", "ji", "chi"] },
      { question: "す", correct: "su", options: ["su", "zu", "tsu"] },
      { question: "せ", correct: "se", options: ["se", "ze", "te"] },
      { question: "そ", correct: "so", options: ["so", "zo", "to"] }
    ],
    ta: [
      { question: "た", correct: "ta", options: ["ta", "da", "na"] },
      { question: "ち", correct: "chi", options: ["chi", "ji", "shi"] },
      { question: "つ", correct: "tsu", options: ["tsu", "zu", "su"] },
      { question: "て", correct: "te", options: ["te", "de", "ne"] },
      { question: "と", correct: "to", options: ["to", "do", "no"] }
    ],
    na: [
      { question: "な", correct: "na", options: ["na", "ta", "ma"] },
      { question: "に", correct: "ni", options: ["ni", "mi", "ri"] },
      { question: "ぬ", correct: "nu", options: ["nu", "mu", "ku"] },
      { question: "ね", correct: "ne", options: ["ne", "re", "me"] },
      { question: "の", correct: "no", options: ["no", "to", "mo"] }
    ],
    ha: [
      { question: "は", correct: "ha", options: ["ha", "ba", "pa"] },
      { question: "ひ", correct: "hi", options: ["hi", "bi", "pi"] },
      { question: "ふ", correct: "fu", options: ["fu", "bu", "pu"] },
      { question: "へ", correct: "he", options: ["he", "be", "pe"] },
      { question: "ほ", correct: "ho", options: ["ho", "bo", "po"] }
    ],
    ma: [
      { question: "ま", correct: "ma", options: ["ma", "na", "ba"] },
      { question: "み", correct: "mi", options: ["mi", "ni", "ri"] },
      { question: "む", correct: "mu", options: ["mu", "nu", "ku"] },
      { question: "め", correct: "me", options: ["me", "ne", "re"] },
      { question: "も", correct: "mo", options: ["mo", "no", "to"] }
    ],
    ya: [
      { question: "や", correct: "ya", options: ["ya", "wa", "ra"] },
      { question: "ゆ", correct: "yu", options: ["yu", "yo", "yu"] },
      { question: "よ", correct: "yo", options: ["yo", "yu", "ya"] }
    ],
    ra: [
      { question: "ら", correct: "ra", options: ["ra", "la", "na"] },
      { question: "り", correct: "ri", options: ["ri", "li", "mi"] },
      { question: "る", correct: "ru", options: ["ru", "lu", "ku"] },
      { question: "れ", correct: "re", options: ["re", "le", "ne"] },
      { question: "ろ", correct: "ro", options: ["ro", "lo", "to"] }
    ],
    wa: [
      { question: "わ", correct: "wa", options: ["wa", "ra", "ma"] },
      { question: "を", correct: "wo", options: ["wo", "o", "mo"] }
    ],
    n: [
      { question: "ん", correct: "n", options: ["n", "m", "nn"] }
    ]
  },
  katakana: {
    a: [
      { question: "ア", correct: "a", options: ["a", "i", "u"] },
      { question: "イ", correct: "i", options: ["e", "i", "a"] },
      { question: "ウ", correct: "u", options: ["o", "u", "e"] },
      { question: "エ", correct: "e", options: ["i", "e", "a"] },
      { question: "オ", correct: "o", options: ["o", "u", "e"] }
    ],
    ka: [
      { question: "カ", correct: "ka", options: ["ka", "ga", "ha"] },
      { question: "キ", correct: "ki", options: ["ki", "gi", "ri"] },
      { question: "ク", correct: "ku", options: ["ku", "gu", "su"] },
      { question: "ケ", correct: "ke", options: ["ke", "ge", "te"] },
      { question: "コ", correct: "ko", options: ["ho", "ko", "mo"] }
    ],
    sa: [
      { question: "サ", correct: "sa", options: ["sa", "za", "ta"] },
      { question: "シ", correct: "shi", options: ["shi", "ji", "chi"] },
      { question: "ス", correct: "su", options: ["su", "zu", "tsu"] },
      { question: "セ", correct: "se", options: ["se", "ze", "te"] },
      { question: "ソ", correct: "so", options: ["so", "zo", "to"] }
    ],
    ta: [
      { question: "タ", correct: "ta", options: ["ta", "da", "na"] },
      { question: "チ", correct: "chi", options: ["chi", "ji", "shi"] },
      { question: "ツ", correct: "tsu", options: ["tsu", "zu", "su"] },
      { question: "テ", correct: "te", options: ["te", "de", "ne"] },
      { question: "ト", correct: "to", options: ["to", "do", "no"] }
    ],
    na: [
      { question: "ナ", correct: "na", options: ["na", "ta", "ma"] },
      { question: "ニ", correct: "ni", options: ["ni", "mi", "ri"] },
      { question: "ヌ", correct: "nu", options: ["nu", "mu", "ku"] },
      { question: "ネ", correct: "ne", options: ["ne", "re", "me"] },
      { question: "ノ", correct: "no", options: ["no", "to", "mo"] }
    ],
    ha: [
      { question: "ハ", correct: "ha", options: ["ha", "ba", "pa"] },
      { question: "ヒ", correct: "hi", options: ["hi", "bi", "pi"] },
      { question: "フ", correct: "fu", options: ["fu", "bu", "pu"] },
      { question: "ヘ", correct: "he", options: ["he", "be", "pe"] },
      { question: "ホ", correct: "ho", options: ["ho", "bo", "po"] }
    ],
    ma: [
      { question: "マ", correct: "ma", options: ["ma", "na", "ba"] },
      { question: "ミ", correct: "mi", options: ["mi", "ni", "ri"] },
      { question: "ム", correct: "mu", options: ["mu", "nu", "ku"] },
      { question: "メ", correct: "me", options: ["me", "ne", "re"] },
      { question: "モ", correct: "mo", options: ["mo", "no", "to"] }
    ],
    ya: [
      { question: "ヤ", correct: "ya", options: ["ya", "wa", "ra"] },
      { question: "ユ", correct: "yu", options: ["yu", "yo", "yu"] },
      { question: "ヨ", correct: "yo", options: ["yo", "yu", "ya"] }
    ],
    ra: [
      { question: "ラ", correct: "ra", options: ["ra", "la", "na"] },
      { question: "リ", correct: "ri", options: ["ri", "li", "mi"] },
      { question: "ル", correct: "ru", options: ["ru", "lu", "ku"] },
      { question: "レ", correct: "re", options: ["re", "le", "ne"] },
      { question: "ロ", correct: "ro", options: ["ro", "lo", "to"] }
    ],
    wa: [
      { question: "ワ", correct: "wa", options: ["wa", "ra", "ma"] },
      { question: "ヲ", correct: "wo", options: ["wo", "o", "mo"] }
    ],
    n: [
      { question: "ン", correct: "n", options: ["n", "m", "nn"] }
    ]
  }
};


    let currentScript = 'hiragana';
    let currentCategory = 'a';
    let currentQuestion;
    let timer = 10;
    let timerId;
    let score = 0;
    let streak = 0;
    let isPaused = false;
    let answerLock = false;

    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");
    const scoreEl = document.getElementById("score");
    const streakEl = document.getElementById("streak");
    const timerEl = document.getElementById("timer");
    const pauseBtn = document.getElementById("pauseBtn");
    const resumeBtn = document.getElementById("resumeBtn");

    function pickQuestion() {
      const questions = kanaData[currentScript][currentCategory];
      currentQuestion = questions[Math.floor(Math.random() * questions.length)];
    }

    function renderQuestion() {
      questionEl.textContent = currentQuestion.question;
      optionsEl.innerHTML = "";
      currentQuestion.options.forEach(option => {
        const btn = document.createElement("button");
        btn.textContent = option;
        btn.onclick = () => answer(option, btn);
        optionsEl.appendChild(btn);
      });
      answerLock = false;
    }

    function answer(selected, btn) {
      if (answerLock) return;
      answerLock = true;
      [...optionsEl.children].forEach(b => b.disabled = true);

      if (selected === currentQuestion.correct) {
        btn.style.backgroundColor = "#28a745";
        score++;
        streak++;
      } else {
        btn.style.backgroundColor = "#dc3545";
        streak = 0;
      }

      updateScore();
      setTimeout(() => nextQuestion(), 700);
    }

    function updateScore() {
      scoreEl.textContent = score;
      streakEl.textContent = streak;
    }

    function startTimer() {
      clearInterval(timerId);
      timer = 10;
      timerEl.textContent = `Zeit: ${timer}`;
      timerId = setInterval(() => {
        if (!isPaused) {
          timer--;
          timerEl.textContent = `Zeit: ${timer}`;
          if (timer <= 0) {
            clearInterval(timerId);
            streak = 0;
            updateScore();
            nextQuestion();
          }
        }
      }, 1000);
    }

    function nextQuestion() {
      pickQuestion();
      renderQuestion();
      startTimer();
    }

    pauseBtn.onclick = () => {
      isPaused = true;
      clearInterval(timerId);
      pauseBtn.style.display = "none";
      resumeBtn.style.display = "inline-block";
    };

    resumeBtn.onclick = () => {
      isPaused = false;
      pauseBtn.style.display = "inline-block";
      resumeBtn.style.display = "none";
      nextQuestion(); // reset question and timer
    };

    document.getElementById("script").onchange = e => {
      currentScript = e.target.value;
      score = 0;
      streak = 0;
      updateScore();
      nextQuestion();
    };

    document.getElementById("category").onchange = e => {
      currentCategory = e.target.value;
      score = 0;
      streak = 0;
      updateScore();
      nextQuestion();
    };

    window.onload = () => {
      nextQuestion();
    };
  </script>
</body>
</html>
